# 분산락 성능 비교 보고서

## 테스트 개요

쿠폰 발급 API에 대해 분산락(Redisson)을 적용한 경우와 적용하지 않은 경우의 성능을 비교한 내용입니다. 동시 요청 상황에서 분산락의 성능 영향을 파악하기 위해 **k6 부하 테스트** 도구를 사용하여 측정

## 테스트 환경

* **서버 프레임워크:** Spring Boot (Java)
* **데이터베이스:** MySQL (Testcontainers 기반)
* **부하 테스트 도구:** k6
* **동시 사용자 수:** 100 VUs
* **테스트 시간:** 5초
* **API 엔드포인트:** `/coupons/issue`

## 테스트 시나리오

| 시나리오        | 설명                                           |
| ----------- | -------------------------------------------- |
| **분산락 적용**  | AOP 기반 **Redisson** 분산락 적용. 쿠폰 발급 시 동시 접근 제어 |
| **분산락 미적용** | 동시성 제어 미적용. 경쟁 조건 발생 가능성 존재                  |

## 테스트 결과 비교

| 항목                  | 분산락 적용        | 분산락 미적용       |
| ------------------- | ------------- | ------------- |
| **평균 응답 시간 (avg)**  | 120.23ms      | 90.35ms       |
| **최소 응답 시간 (min)**  | 2.48ms        | 2.86ms        |
| **중앙값 응답 시간 (p50)** | 54.7ms        | 32.75ms       |
| **최대 응답 시간 (max)**  | 607.61ms      | 480.32ms      |
| **90퍼센타일 (p90)**    | 338.79ms      | 337.53ms      |
| **95퍼센타일 (p95)**    | 398.49ms      | 423.45ms      |
| **요청 수**            | 500 (84.91/s) | 500 (90.03/s) |
| **실패율**             | 0%            | 0%            |

##  성능 분석

* 분산락 적용 시 최대 응답 시간은 증가했지만, p95 기준으로는 오히려 더 빠름 → 응답 시간 분포가 안정적임을 의미
* 평균 및 중앙값 응답 시간이 증가 → 락 획득 및 해제에 따른 부가 비용 존재



