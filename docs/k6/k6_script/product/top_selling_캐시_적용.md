# 인기상품 조회 레디스 캐시 적용 보고서

## 목표

* 원천 데이터와 캐시 데이터의 일관성 유지
* 효율적인 캐시 만료 및 갱신 전략 수립
* 캐시 적용 전/후 성능 비교를 통한 효과 검증

---

## 캐시 적용 배경

* 인기상품 조회는 동일한 쿼리에 대해 다수의 사용자 요청이 집중될 수 있는 엔드포인트입니다.
* 동시 요청 시 데이터베이스에 부하가 큼
* 데이터 변경 빈도가 낮고 실시간성이 강하게 요구되지 않음
* 따라서 캐시를 통해 응답 속도를 개선하고 DB 부하를 완화할 수 있습니다.

---

## ️ 캐시 적용 이유

* **빈번한 조회**: 인기 상품 조회는 자주 요청되나 자주 변경되지는 않음
* **데이터 안정성**: 집계 기준이 하루 단위로 충분함
* **응답 속도 개선**: 캐시를 통해 쿼리 및 DB 접근 제거 가능

---

## 캐시 만료 전략

### 하이브리드 전략 적용

* **TTL 설정**: 24시간 (86400초)
* **Eviction (명시적 캐시 삭제)**: 매일 자정 (00:00) 스케줄링

```java
@Scheduled(cron = "0 0 0 * * ?")
@CacheEvict(value = "popularProducts", key = "'popular'")
public void refreshPopularProductsCache() {
    System.out.println("[캐시 초기화] 인기 상품 캐시가 초기화되었습니다.");
}
```

### 이유

* **TTL 24시간**: 집계 쿼리는 하루 단위로 계산되므로, TTL로도 충분히 최신 데이터 유지 가능
* **스케줄링 기반 Eviction**: 집계가 갱신되는 자정에 맞춰 강제 초기화하여 정확도 확보

---

## k6 부하 테스트 결과

| **구분**          | **캐시 적용** | **캐시 미적용** |
| --------------- | --------- | ---------- |
| **p(95) 응답 시간** | 10.33ms   | 26.86ms    |
| **평균 응답 시간**    | 4.49ms    | 14.69ms    |
| **HTTP 요청 수**   | 963       | 956        |
| **오류율**         | 0%        | 0%         |
| **성공률**         | 100%      | 100%       |

### 성능 개선 효과

* **p(95) 응답 시간 2.6배 개선 (26.86ms → 10.33ms)**
* **평균 응답 시간 3.3배 개선 (14.69ms → 4.49ms)**

---

##  결론

* 인기상품 조회는 **같은 쿼리가 동시 요청되며 부하가 집중**되는 엔드포인트이므로 캐시 적용에 매우 적합
* **하루 1회 갱신되는 집계 데이터**이므로 TTL+Eviction 하이브리드 전략이 정확성과 성능 모두 보장


